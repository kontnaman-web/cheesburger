<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Dodge Game</title>
</head>
<body>

<canvas id="game" width="400" height="500"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let player = { x: 180, y: 450, w: 40, h: 40 };
let enemies = [];
let frame = 0;
let alive = true;
let score = 0;

document.addEventListener("keydown", e => {
  if (e.key === "ArrowLeft") player.x -= 20;
  if (e.key === "ArrowRight") player.x += 20;
});

function spawnEnemy() {
  enemies.push({
    x: Math.random() * 360,
    y: -40,
    w: 40,
    h: 40
  });
}

function collision(a, b) {
  return (
    a.x < b.x + b.w &&
    a.x + a.w > b.x &&
    a.y < b.y + b.h &&
    a.y + a.h > b.y
  );
}

function loop() {
  if (!alive) return;

  ctx.clearRect(0, 0, 400, 500);

  // Spieler
  ctx.fillStyle = "blue";
  ctx.fillRect(player.x, player.y, player.w, player.h);

  // Gegner
  if (frame % 30 === 0) spawnEnemy();

  ctx.fillStyle = "red";
  enemies.forEach(e => {
    e.y += 5;
    ctx.fillRect(e.x, e.y, e.w, e.h);

    if (collision(player, e)) {
      alive = false;
    }
  });

  enemies = enemies.filter(e => e.y < 500);

  // Score
  score++;
  ctx.fillStyle = "black";
  ctx.font = "20px Arial";
  ctx.fillText("Score: " + score, 10, 30);

  if (!alive) {
    ctx.fillText("GAME OVER - Seite neu laden", 80, 250);
    return;
  }

  frame++;
  requestAnimationFrame(loop);
}

loop();
</script>

</body>
</html>
